<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Restaurante.Views.PedidosView"
             Title="Pedidos de Mesa">

    <Grid RowDefinitions="Auto, *" Padding="10">

        <!-- Parte superior: título + botón -->
        <VerticalStackLayout Grid.Row="0" Spacing="10">
            <Label Text="Pedidos de la Mesa"
                   FontSize="28"
                   FontAttributes="Bold"
                   HorizontalOptions="Center"
                   TextColor="Black" />

            <HorizontalStackLayout Spacing="10" HorizontalOptions="CenterAndExpand">
                <Button Text="Agregar Pedido"
            FontSize="20"
            CornerRadius="15"
            BackgroundColor="MediumSeaGreen"
            TextColor="White"
            Padding="10"
            Command="{Binding AgregarCommand}" />

                <Button Text="{Binding TotalTexto}"
        FontSize="20"
        CornerRadius="15"
        BackgroundColor="DarkOrange"
        TextColor="White"
        Padding="10"
        Command="{Binding PagarCommand}"
        IsEnabled="{Binding PuedePagar}" />

            </HorizontalStackLayout>
        </VerticalStackLayout>

        <!-- CollectionView con scroll -->
        <CollectionView Grid.Row="1"
                        Margin="0,10,0,0"
                        ItemsSource="{Binding Pedidos}"
                        SelectionMode="None"
                        x:Name="PedidosCollectionView"
                        VerticalOptions="FillAndExpand">
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <SwipeView>
                        <SwipeView.RightItems>
                            <SwipeItems Mode="Reveal">
                                <SwipeItem
                            BackgroundColor="IndianRed"
                            IconImageSource="delete.png"
                            Command="{Binding BindingContext.EliminarCommand, Source={x:Reference PedidosCollectionView}}"
                            CommandParameter="{Binding .}" />
                            </SwipeItems>
                        </SwipeView.RightItems>

                        <!-- Tu contenido actual -->
                        <Frame BorderColor="LightGray"
                           CornerRadius="12"
                           Padding="15"
                           Margin="5"
                           HasShadow="True">
                            <VerticalStackLayout Spacing="5">

                                <!-- Nombre del elemento -->
                                <Label Text="{Binding ElementoMenuPedido.Nombre}"
                                   FontSize="20"
                                   FontAttributes="Bold"
                                   TextColor="Black" />

                                <!-- Control de cantidad -->
                                <HorizontalStackLayout Spacing="10" VerticalOptions="Center">
                                    <Label Text="Cantidad:" VerticalOptions="Center" />

                                    <ImageButton Source="menos.png"
                                        WidthRequest="30"
                                        HeightRequest="30"
                                        Command="{Binding BindingContext.DecrementarCantidadCommand, Source={x:Reference PedidosCollectionView}}"
                                        CommandParameter="{Binding .}" />

                                    <Label Text="{Binding Cantidad}" VerticalOptions="Center" />

                                    <ImageButton Source="mas.png"
                                        WidthRequest="30"
                                        HeightRequest="30"
                                        Command="{Binding BindingContext.IncrementarCantidadCommand, Source={x:Reference PedidosCollectionView}}"
                                        CommandParameter="{Binding .}" />
                                </HorizontalStackLayout>

                                <!-- Precio del elemento -->
                                <Label Text="{Binding ElementoMenuPedido.Precio, StringFormat='Precio: {0:C}'}"
                                   FontSize="16"
                                   TextColor="DarkSlateGray" />
                            </VerticalStackLayout>
                        </Frame>
                </SwipeView>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

    </Grid>
</ContentPage>
